---
title: "Readings in Database Systems. 1. Основы"
date: 2020-07-12T12:41:13+03:00
summary: "
Я поражен тем, что эти две статьи были написаны всего десять лет назад! Моё
восхищение относительно статьи по внутренностям вызвано тем, насколько сильно
изменились детали всего несколько лет спустя. Мое изумление по поводу статьи по
моделям данных состоит в том, что никто никогда не извлекает уроки из истории.
Давайте сначала поговорим о статье по работе с моделями данных."
draft: false
categories:
- readings in database systems
- red book
- map-reduce
- data lake
- json
- xml
- hdfs
---

# 1. Основы

> Избранные статьи:
>
> - Joseph M. Hellerstein and Michael Stonebraker. What Goes Around Comes
>   Around. *Readings in Database Systems*, 4th Edition (2005).
> - Joseph M. Hellerstein, Michael Stonebraker, James Hamilton. Architecture of
>   a Database System. *Foundations and Trends in Databases*, 1, 2 (2007).

{{< param Summary >}}

Десять лет назад у всех на слуху был XML. Вендоры намеревались добавить XML в
свои реляционные движки. Отраслевые аналитики (и более чем, несколько
исследователей) рекламировали XML как «следующую большую вещь». Через десяток
лет, это всего лишь нишевый продукт, а отрасль продолжила развиваться. На мой
взгляд, (как и предсказывалось в статье) он уступил комбинации:

- чрезмерная сложность (которую никто не мог понять)
- сложные расширения реляционных движков, которые, кажется, не работают
  достаточно хорошо
- нет убедительного варианта использования, где бы он широко принянялся

Немного иронично, что в статье был сделан прогноз, что X выиграет премию
Тьюринга, успешно упростив XML. Этот прогноз оказался полностью неверным!
Чистая сеть была той реляционной победой, а XML проиграл.

Конечно, это не помешало новичкам изобретать велосипед. Теперь это JSON, который
можно посмотреть одним из трех способов:

- Общий иерархический формат данных. Любой, кто считает это хорошей идеей,
  должен прочитать раздел документа по модели данных в IMS.
- Представление для разреженных данных. Рассмотрим атрибуты о сотруднике и
  предположим, что мы хотим записать данные о хобби. Для каждого хобби данные,
  которые мы записываем, будут разными, а хобби фундаментально редкими. Это
  легко моделировать в реляционной СУБД, но приводит к очень широким и очень
  разреженным таблицам. Это катастрофично для дисковых построковых хранилищ, но
  отлично работает в поколоночных хранилищах. В последнем случае JSON является
  приемлемым форматом кодирования для столбца «хобби», и несколько РСУБД недавно
  добавили поддержку типа данных JSON.
- Как механизм для «схемы на чтение». В сущности, схема очень широкая и очень
  разреженная, и, по сути, все пользователи захотят получить некоторую проекцию
  этой схемы. При чтении из широкой разреженной схемы пользователь может
  сказать, что он хочет видеть во время выполнения. Концептуально, это не что
  иное, как операция проекции. Следовательно, «схема на чтение» - это просто
  реляционная операция над данными в кодировке JSON.

Таким образом, JSON является разумным выбором для разреженных данных. В этом
контексте я ожидаю, что у него будет достаточное количество «ног». С другой
стороны, это будет катастрофой, если его сделать общим иерархическим форматом
данных. Я ожидаю, что СУБД будут использовать JSON как простой тип данных
(среди многих) в своих системах. Другими словами, это разумный способ
кодирования резервных реляционных данных. Без сомнения, в следующей версии
«Красной книги» появится новый иерархический формат, придуманный людьми, которые
стоят на пальцах ног своих предшественников, а не на их плечах.

Другая модель данных, которая вызвала много шума в последнее десятилетие - это
Map-Reduce, специально созданная Google для поддержки своей базы данных
веб-сканирования. Несколько лет спустя Google прекратил использовать Map-Reduce
для этого приложения, перейдя вместо этого на Big Table. Теперь остальной мир
видит, что Google выяснил ранее: Map-Reduce - это не архитектура с какой-либо
широкой применимостью. Вместо этого рынок Map-Reduce превратился в рынок HDFS и,
похоже, готов стать рынком реляционных SQL. Например, Cloudera недавно
представила Impala - движок SQL, построенный на основе HDFS, не использующий
Map-Reduce.

Совсем недавно в мире HDFS возникло еще одно направление, заслуживающее
обсуждения, а именно «озера данных». Разумное использование кластера HDFS (в
который, в настоящее время, большинство предприятий вложили средства и хотят найти
что-то полезное для них) - это как очередь файлов данных, которые были
загружены. Со временем предприятия выяснят, какие из них стоит потратить на
очистку (оценка данных; рассматривается в главе 12 этой книги). Следовательно,
озеро данных - это просто «ящик для мусора» для файлов. Кроме того, мы расскажем
больше о HDFS, Spark и Hadoop в главе 5.

Таким образом, в последнее десятилетие никто, кажется, не учел уроки из "What
Goes Around Comes Around".  Новые модели данных были изобретены только для
преобразования в SQL для таблиц. Иерархические структуры были заново изобретены
с провалом в качестве предсказанного результата. Я не удивлюсь, увидев, что
следующее десятилетие будет таким же. Люди, кажется, обречены изобретать велосипед!

Что касается статьи о внутренностях: всего лишь спустя десятилетие мы можем
отметить существенные изменения в том, как построены СУБД. Следовательно, детали
сильно изменились, но общая архитектура, описанная в статье, все еще в
значительной степени верна. В документе описывается, как работает большинство
унаследованных СУБД (например, Oracle, DB2), а десять лет назад это была
распространенная реализация. Теперь эти системы являются историческими
артефактами; не очень хорошими во всём. Например, на рынке хранилищ данных
столбцовые движки заменили строковые, описанные в этом документе, поскольку
они на 1–2 порядка быстрее. В мире OLTP SQL движки в основной памяти с очень
легкими транзакциями быстро становятся нормой. Эти новые разработки описаны
в главе 4 этой книги. В настоящее время трудно найти область применения, где
устаревшие построчные хранилища конкурентоспособны. Как таковые, они заслуживают
того, чтобы их отправили в «дом для старых программ».
 
Трудно представить, что «один размер подходит всем» когда-нибудь снова станет
доминирующей архитектурой. Следовательно, у «слонов» есть проблема «дилеммы
новаторов». В классической книге Клейтона Кристиансена он утверждает, что
поставщикам устаревших технологий трудно трансформироваться в новые конструкции,
не теряя при этом свою клиентскую базу. Однако уже очевидно, как будут пытаться
слоны. Например, SQLServer 14 - это как минимум два движка (Hekaton - система
OLTP с основной памятью и обычный SQLServer - устаревшее хранилище строк),
объединенных под общим парсером. Следовательно, стратегия Microsoft состоит в
том, чтобы явно добавлять новые движки под их унаследованный синтаксический
анализатор, а затем поддерживать перемещение данных из устаревшего движка в
более современные, не мешая приложениям. Еще неизвестно, насколько успешным это
будет.

Однако базовая архитектура этих новых систем продолжает следовать структуре
синтаксического анализа/оптимизатора/исполнителя, описанной в этой статье.
Кроме того, модель потоков и структура процессов сегодня так же актуальны, как и
десять лет назад. Таким образом, читатель должен отметить, что детали управления
параллелизмом, восстановления после сбоев, оптимизации, структур данных и
индексации находятся в состоянии быстрого изменения, но базовая архитектура СУБД
остается неизменной.

Кроме того, этим устаревшим системам потребуется много времени, чтобы умереть.
На самом деле, все еще существует огромное количество данных IMS в
промышленном использовании. Таким образом, любому студенту в данной области
настоятельно рекомендуется понимать архитектуру (доминирующую на некоторое
время) систем.

Кроме того, возможно, что аспекты этой статьи могут стать более актуальными в
будущем по мере развития вычислительной архитектуры. Например, предстоящее
появление NVRAM может предоставить возможность для новых архитектурных концепций
или возрождения старых.
